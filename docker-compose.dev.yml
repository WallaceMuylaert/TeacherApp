# Docker Compose para DESENVOLVIMENTO
# Uso: docker compose -f docker-compose.dev.yml up
# Características:
#   - Hot reload habilitado no backend (uvicorn --reload)
#   - Hot reload habilitado no frontend (npm run dev)
#   - Volumes montados para refletir alterações em tempo real
#   - Não precisa rebuild para ver alterações no código

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend.dev
    container_name: teacher_app_backend_dev
    restart: unless-stopped
    volumes:
      - ./backend:/app/backend # Monta o código fonte para hot reload
      - sqlite_data:/app/db
    env_file:
      - .env
    environment:
      - DB_PATH=/app/db/student_management.db
    ports:
      - "${PORT_BACKEND}:8000"

  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend.dev
    container_name: teacher_app_frontend_dev
    restart: unless-stopped
    volumes:
      - ./frontend:/app # Monta o código fonte para hot reload
      - /app/node_modules # Evita sobrescrever node_modules do container
    depends_on:
      - backend
    ports:
      - "${PORT_FRONTEND}:5173" # Usa a porta do .env externamente, 5173 internamente (Vite)

volumes:
  sqlite_data:
